{% extends "base.html" %}
{% load static %}
{% block title %}Visary | Login{% endblock %}

{% block base_styles %}
    {{ block.super }}

    body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: radial-gradient(circle at 20% 18%, rgba(86, 244, 156, 0.12), transparent 40%),
                    radial-gradient(circle at 82% 12%, rgba(48, 150, 255, 0.15), transparent 42%),
                    #050b1a;
        padding: clamp(24px, 8vh, 60px) clamp(16px, 6vw, 48px);
    }

    .login-card {
        position: relative;
        width: min(440px, 100%);
        background: rgba(7, 15, 28, 0.82);
        border-radius: 34px;
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 42px 120px rgba(3, 6, 12, 0.65);
        padding: clamp(40px, 9vw, 56px);
        display: grid;
        gap: clamp(28px, 5vw, 38px);
        color: #f5f7ff;
        overflow: hidden;
    }

    .login-card::before {
        content: "";
        position: absolute;
        inset: 0;
        background:
            radial-gradient(120% 120% at 60% -10%, rgba(86, 244, 156, 0.72) 0%, rgba(86, 244, 156, 0.05) 55%, transparent 70%),
            linear-gradient(180deg, rgba(14, 30, 54, 0.92) 0%, rgba(7, 13, 26, 0.94) 100%);
        pointer-events: none;
    }

    .login-card > * {
        position: relative;
        z-index: 1;
    }

    .login-header {
        display: grid;
        gap: clamp(16px, 4vw, 24px);
        text-align: center;
    }

    .login-header img {
        width: clamp(210px, 58vw, 280px);
        height: auto;
        margin-inline: auto;
        filter: drop-shadow(0 22px 40px rgba(6, 14, 32, 0.45));
    }

    .login-header h1 {
        margin: 0;
        font-size: clamp(1.9rem, 3.6vw, 2.4rem);
        font-weight: 700;
        letter-spacing: 0.02em;
    }

    .login-header p {
        margin: 0;
        color: rgba(245, 247, 255, 0.78);
        font-size: 0.95rem;
        line-height: 1.55;
    }

    .login-card form {
        display: grid;
        gap: 22px;
    }

    .login-card label {
        display: block;
        font-size: 0.78rem;
        font-weight: 600;
        letter-spacing: 0.08em;
        color: rgba(245, 247, 255, 0.68);
        margin-bottom: 8px;
        text-transform: uppercase;
    }

    .login-card input[type="text"],
    .login-card input[type="email"],
    .login-card input[type="password"] {
        width: 100%;
        padding: 14px 18px;
        border-radius: 18px;
        border: 1px solid rgba(255, 255, 255, 0.16);
        background: rgba(5, 12, 25, 0.88);
        color: #f5f7ff;
        font-size: 0.96rem;
        transition: border 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
    }

    .login-card input:focus {
        outline: none;
        border-color: rgba(86, 244, 156, 0.85);
        box-shadow: 0 0 0 4px rgba(86, 244, 156, 0.16);
        transform: translateY(-1px);
    }

    .remember {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 18px;
        font-size: 0.84rem;
        color: rgba(245, 247, 255, 0.78);
    }

    .remember label {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        margin: 0;
        text-transform: none;
        letter-spacing: normal;
        font-weight: 500;
    }

    .remember input[type="checkbox"] {
        width: auto;
        accent-color: #5df4a9;
    }

    .forget-link {
        color: #5df4a9;
        font-weight: 600;
    }

    .messages {
        margin: 0;
        padding: 0;
        display: grid;
        gap: 12px;
    }

    .messages li {
        padding: 12px 16px;
        border-radius: 14px;
        font-size: 0.88rem;
        font-weight: 600;
    }

    .messages .error {
        background: rgba(240, 64, 90, 0.16);
        border: 1px solid rgba(240, 64, 90, 0.34);
        color: #ff8096;
    }

    .messages .success {
        background: rgba(86, 244, 156, 0.18);
        border: 1px solid rgba(86, 244, 156, 0.34);
        color: #ccffe5;
    }

    .login-actions {
        display: grid;
        gap: 18px;
    }

    .login-submit {
        width: 100%;
        border-radius: 22px;
        padding: 16px;
        font-size: 1rem;
        font-weight: 700;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        border: none;
        background: linear-gradient(135deg, #5df4a9, #31b9ff);
        color: #071124;
        cursor: pointer;
        box-shadow: 0 34px 90px rgba(61, 210, 192, 0.36);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .login-submit:hover {
        transform: translateY(-2px);
        box-shadow: 0 38px 104px rgba(61, 210, 192, 0.42);
    }

    .login-submit:active {
        transform: translateY(0);
    }

    .login-footer {
        text-align: center;
        font-size: 0.86rem;
        color: rgba(245, 247, 255, 0.72);
    }

    .login-footer a {
        color: #5df4a9;
        font-weight: 600;
    }

    @media (max-width: 540px) {
        body {
            padding: clamp(24px, 12vh, 48px) clamp(12px, 8vw, 24px);
        }

        .login-card {
            padding: clamp(32px, 11vw, 40px);
            border-radius: 28px;
        }

        .remember {
            flex-direction: column;
            align-items: flex-start;
            gap: 12px;
        }
    }
{% endblock %}

{% block body %}
<section class="login-card">
    <header class="login-header">
        <img src="{% static 'logo/logo.png' %}" alt="Visary Assessoria Consular">
        <div>
            <h1>Bem-vindo(a)</h1>
            <p>Acesse sua conta. O sistema identificará automaticamente se você é consultor, administrador ou cliente.</p>
        </div>
    </header>

    {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li class="{{ message.tags }}">{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    <form method="post" action="{% url 'login' %}" novalidate>
        {% csrf_token %}
        <div>
            <label for="{{ form.identifier.id_for_label }}">CPF (clientes) ou e-mail (consultores)</label>
            {{ form.identifier }}
            {{ form.identifier.errors }}
        </div>
        <div>
            <label for="{{ form.password.id_for_label }}">Senha</label>
            {{ form.password }}
            {{ form.password.errors }}
        </div>
        <div class="remember">
            <label for="{{ form.remember_me.id_for_label }}">
                {{ form.remember_me }} {{ form.remember_me.label }}
            </label>
            <a class="forget-link" href="#">Esqueci minha senha</a>
        </div>
        <input type="hidden" name="next" value="{{ request.GET.next }}">
        <div class="login-actions">
            <button type="submit" class="login-submit">Entrar</button>
        </div>
    </form>

    <p class="login-footer">
        Precisa de suporte? <a href="#">Fale com a Visary</a>
    </p>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
    (function () {
        const identifier = document.getElementById("id_identifier");
        const password = document.getElementById("id_password");
        if (identifier) {
            identifier.placeholder = identifier.placeholder || "CPF (000.000.000-00) ou e-mail";
            identifier.autocomplete = "username";
        }
        if (password) {
            password.placeholder = "Sua senha";
            password.autocomplete = "current-password";
        }
    }());
</script>
{% endblock %}
